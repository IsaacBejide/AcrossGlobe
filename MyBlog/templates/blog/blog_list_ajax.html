{% load i18n %}
{% load thumbnail %}

<div class="container mt-2 mb-2">
  <div class="card">
    <div class="card-header">
      <b>{% trans "Latest News" %}</b>
    </div>
    <div class="card-body">
      <div class="container">
          <div class="row">
            {% for post in posts %}
              <div class="col-sm-4 my-1">
                  <div class="card shadow" style="width: 20rem; height: 18rem;">
                      {% if post.image %}
                        <a href="/blog/{{post.slug}}"><img src="{% thumbnail post.image 100x100 %}"></a>
                        {% comment %} <a href="blog/{{post.slug}}"><img src="/media/{{post.image}}" class="card-img-top" alt="..." height="100px"></a>
                        <a href="blog/{{post.slug}}"><img src="{% thumbnail '/media/{{post.image}}' %}" class="card-img-top" alt="..." height="120px"></a> {% endcomment %}
                      {% endif %}
                    
                      <div class="card-body">
                        <h6 class="card-title"><a href="/blog/{{post.slug}}">{{post.title}}</a> 
                          <br>
                            <div>
                              <small>by <a href="#" hx-get="/user_profile/{{post.author.id}}/" hx-target="#dialog">{{post.author}}  <span style="font-size: 12px;">{{post.dateTime}}</span>
                                {% if user.is_superuser %}
                                  <a href="delete_blog_post/{{post.slug}}/">{% trans "Delete Blog" %}</a>
                                {% endif %}</a>
                              </small>
                            <div>
                        </h6>
                      </div>

                      <div class="card-footer">
                        <a> 
                            {% with total_likes=post.users_like.count users_like=post.users_like.all %}
                              <span class="total">{{ total_likes }}</span> like{{ total_likes|pluralize }}
                            {% endwith %} <span class="float-right"> ({{ post.viewers.count }} Views) </span></a>
                      </div>
                    </div>
              </div>
            {% endfor %}
          </div>
      </div>
    </div>

    <div class="card-footer">
      {% if posts.has_other_pages %}
        <nav aria-label="Page navigation conatiner"></nav>
          <ul class="pagination justify-content-center">
            {% if posts.has_previous %}
              <li><a href="?page={{ posts.previous_page_number }}" class="page-link">&laquo; {% trans "PREV" %} </a></li>
            {% endif %}
            {% if posts.has_next %}
              <li><a href="?page={{ posts.next_page_number }}" class="page-link"> {% trans "NEXT" %} &raquo;</a></li>
          {% endif %}
          </ul>
      {% endif %}
    </div>
  </div>
</div>
